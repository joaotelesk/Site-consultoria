// Components
import { Carousel } from "@/components/Carousel/Carousel";
import { TextInput } from "@/components/InputText/InputText";
import Head from "next/head";
import Image from "next/image";
import Link from "next/link";
import { useToast } from "@chakra-ui/react";

// Hooks
import { useState } from "react";

// Utilities
import { useMutation } from "@apollo/client";
import { SUBSCRIBE_MUTATION } from "@/graphql/mutations/mutation";

const emailRegex = /\S+@\S+\.\S+/;

const ServiceData = [
  {
    title: "Cidadania Portuguesa",
    description:
      "Oferecemos uma variedade de serviços para os nossos assessorados que buscam o sonho de viver em Portugal e Itália!",
    link: "#",
    image: "/Home/service1.png",
    alt: "imagem de uma mulher referente a servicos cidadania Portuguesa",
  },
  {
    title: "Cidadania Italina",
    description:
      "Oferecemos uma variedade de serviços para os nossos assessorados que buscam o sonho de viver em Portugal e Itália!",
    link: "#",
    image: "/Home/service2.png",
    alt: "imagem de uma mulher referente a servicos cidadania Portuguesa",
  },
  {
    title: "Visto Portugues",
    description:
      "Oferecemos uma variedade de serviços para os nossos assessorados que buscam o sonho de viver em Portugal e Itália!",
    link: "#",
    image: "/Home/service3.svg",
    alt: "imagem de uma mulher referente a servicos cidadania Portuguesa",
  },
];

export default function Home() {
  const [subscribeValue, setSubscribeValue] = useState("");
  const [subscribe, { loading, error }] = useMutation(SUBSCRIBE_MUTATION);
  const toast = useToast();

  async function handleFormSubmit(event: React.FormEvent) {
    event.preventDefault();
    if (subscribeValue !== "" && emailRegex.test(subscribeValue)) {
      toast({
        title: "Sucesso!",
        position: "top",
        description: `O email ${subscribeValue} foi castrado.`,
        status: "success",
        duration: 3000,

        isClosable: true,
      });
      await subscribe({ variables: { email: subscribeValue } })
        .then(() => {
          console.log("Inscrição realizada com sucesso!");
          setSubscribeValue("");
        })

        .catch(() => {
          console.log("Ocorreu um erro ao inscrever-se.");
          console.log(error);
        });
    } else {
      toast({
        title: "Erro",
        position: "top",
        description: "Preencha o campo de e-mail.",
        status: "info",
        duration: 3000,

        isClosable: true,
      });
    }
  }

  function handleInputChange(event: React.ChangeEvent<HTMLInputElement>) {
    setSubscribeValue(event.target.value);
  }
  return (
    <>
      <Head>
        <title>Home</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <main className="w-full min-h-screen py-0">
        <section className=" text-center lg:text-start items-center bg-green-400 pt-28">
          <div className="container grid grid-cols-1 lg:grid-cols-2 lg:gap-x-11">
            <div className="py-4 lg:py-16 flex flex-col">
              <Image
                src="/Home/bandeiras.png"
                alt="Bandeiras de portugal e italia"
                width={75}
                height={35}
                className="mx-auto lg:ml-0"
              />
              <h1 className="mt-4 text-3xl font-medium  lg:text-5xl text-black-500">
                Assessoria de imigração para Portugal e Itália
              </h1>
              <p className="mx-auto mt-4 lg:mt-3 text-gray-300 text-sm lg:text-xl max-w-md lg:ml-0">
                Conquiste sua cidadania sem se preocupar com burocracias.
                Economize tempo e dinheiro com com a Imigrei!
              </p>
              <Link
                href="#"
                className=" mt-4 lg:mt-11 linkButton text-base  max-w-[209px] mx-auto lg:ml-0"
              >
                Conhecer Serviços
              </Link>
            </div>
            <Image
              src="/Home/banner.svg"
              alt="Imagem banner principal"
              width={426}
              height={418}
              className="self-end mx-auto"
            />
          </div>
        </section>
        <section className="text-center lg:text-start container grid grid-cols-1 lg:grid-cols-2 items-center gap-24 mt-12 lg:my-16 box-white">
          <Image
            src="/Home/quemSomos.svg"
            alt="imagem de uma mulher sorrindo"
            width={345}
            height={362}
            className="order-2 lg:order-1 mx-auto"
          />

          <div className="order-1 lg:order-2 flex flex-col">
            <span className="mt-7 text-green-500 font-medium">Quem Somos</span>
            <h2 className="mt-2 text-2xl sm:text-4xl text-black-400 font-medium">
              Prazer, somos a Imigrei!
            </h2>
            <p className="text-sm sm:text-base mt-4 text-gray-300">
              Oferecemos uma variedade de serviços para os nossos assessorados
              que buscam o sonho de viver em Portugal e Itália! Oferecemos uma
              variedade de serviços para os nossos assessorados que buscam o
              sonho de viver em Portugal e Itália!
            </p>
            <Link
              href="#"
              className="text-sm sm:text-base linkButton self-center lg:self-start my-4"
            >
              Solicitar Atendimento
            </Link>
          </div>
        </section>
        <section className="mt-12 lg:mt-28">
          <div className="text-center container">
            <span className="text-green-500 font-medium">Serviços</span>
            <h2 className="mt-2  text-2xl sm:text-4xl text-black-400 font-medium">
              Conheça as nossas áreas de atuação
            </h2>
            <p className="text-sm sm:text-base mt-4 text-gray-300 mx-auto max-w-xl ">
              Oferecemos uma variedade de serviços para os nossos assessorados
              que buscam o sonho de viver em Portugal e Itália!
            </p>
          </div>
          <div className="mt-6 py-8 box-green overflow-hidden">
            <div className="container">
              <Carousel serviceData={ServiceData} />
            </div>
          </div>
        </section>
        <section className="container my-10 text-center text-gray-500 bg-subscribeSm lg:bg-subscribeLg bg-cover py-14 lg:my-20">
          <span className="mt-7 text-green-500 font-medium">Newsletter</span>
          <h2 className="mt-2 text-2xl sm:text-4xl text-black-400 font-medium">
            Fique por dentro das nossas atualizações!
          </h2>
          <p className="text-sm sm:text-base mt-4 text-gray-300">
            Saiba o que acontece no mundo da imigrações e cidadania em Portugal
            e Itália.
          </p>

          <form
            onSubmit={handleFormSubmit}
            className="flex flex-col items-center lg:items-baseline gap-5  mt-8 justify-center max-w-md mx-auto lg:flex-row"
          >
            <div className="w-64">
              <TextInput.Root>
                <TextInput.Input
                  type="email"
                  value={subscribeValue}
                  placeholder="Digite o seu melhor E-mail"
                  onChange={handleInputChange}
                />
              </TextInput.Root>
            </div>

            <button
              type="submit"
              className="linkButton text-sm lg:text-base mt-4"
              disabled={loading}
            >
              Cadastrar
            </button>
          </form>
        </section>
      </main>
    </>
  );
}
